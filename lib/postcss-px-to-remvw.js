"use strict";function _interopDefault(e){return e&&"object"==typeof e&&"default"in e?e.default:e}var postcss=_interopDefault(require("postcss")),css=_interopDefault(require("css"));function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties(e,t){for(var r=0;r<t.length;r++){var o=t[r];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}function _createClass(e,t,r){return t&&_defineProperties(e.prototype,t),r&&_defineProperties(e,r),e}var extend=function(e,t){for(var r in t)e[r]=t[r];return e},pxRegExp=/\b(\d+(\.\d+)?)px\b/,pxGlobalRegExp=new RegExp(pxRegExp.source,"g"),defaultConfig={baseSize:{rem:75,vw:7.5},precision:6,forceRemProps:["font","font-size"],keepRuleComment:"no",keepFileComment:"pxtoremvw-disable",toRem:!0,toVw:!0},PxConverter=function(){function e(){_classCallCheck(this,e),this.config=extend({},defaultConfig)}return _createClass(e,[{key:"convert",value:function(e){var t=css.parse(e),r=t.stylesheet.rules[0];return r?"comment"===r.type&&r.comment.trim()===this.config.keepFileComment?e:(this.processRules(t.stylesheet.rules),css.stringify(t)):e}},{key:"processRules",value:function(e){var t=this;e.forEach((function(e){if("media"===e.type)return t.processRules(e.rules);if("keyframes"===e.type)return t.processRules(e.keyframes);if("rule"===e.type||"keyframe"===e.type){!function r(o){var n=e.declarations[o];if(n){if("declaration"!==n.type||!pxRegExp.test(n.value))return r(o+1);var i=e.declarations[o+1];if(i&&"comment"===i.type&&i.comment.trim()===t.config.keepRuleComment)return r(o+2);var s=n.value;t.config.toRem&&(n.value=t.getCalcValue("rem",s)),t.config.toVw&&-1===t.config.forceRemProps.indexOf(n.property)?(e.declarations.splice(o+1,0,{type:"declaration",property:n.property,value:t.getCalcValue("vw",s)}),r(o+2)):r(o+1)}}(0)}}))}},{key:"getCalcValue",value:function(e,t){var r=this,o=this.config.baseSize[e];return o?t.replace(pxGlobalRegExp,(function(t,n){return"".concat(parseFloat((n/o).toFixed(r.config.precision))).concat(e)})):t}}]),e}(),plugin=postcss.plugin("postcss-px-to-remvw",(function(e){return function(t,r){if(e.exclude){if("[object RegExp]"!==Object.prototype.toString.call(e.exclude))throw new Error("options.exclude should be RegExp!");if(null!==t.source.input.file.match(e.exclude))return void(r.root=t)}var o=new PxConverter(e).convert(t.toString());r.root=postcss.parse(o)}}));module.exports=plugin;
//# sourceMappingURL=postcss-px-to-remvw.js.map
